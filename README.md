# Document Checker

Инструмент для автоматического сопоставления информации из PDF документов с данными архивных справочников.

## Описание проекта

Document Checker анализирует PDF документы (архивные справки) и извлекает из них ключевую информацию:
- Название архивного отдела
- Наименование организации

Затем выполняется поиск по справочнику (CSV файл) и определяются наиболее близкие совпадения с использованием:
1. Точного текстового поиска по ключевым словам
2. Семантического поиска с использованием векторных вложений (embeddings)

Для повышения производительности используется кэширование векторных представлений.

## Функциональные возможности

- Извлечение структурированных данных из PDF документов
- Точный поиск совпадений по наименованию архива и организации
- Семантический поиск с использованием модели Sentence Transformers
- Кэширование векторных представлений для ускорения повторных запусков
- Детальное логирование процесса обработки документов

## Структура проекта

```
document_checker/
├── data/                   # Данные
│   └── combined_SP.csv     # Справочник
├── document_checker/       # Основной пакет
│   ├── __init__.py
│   ├── main.py             # Основной скрипт запуска
│   ├── config/             # Конфигурационные файлы
│   │   └── config.py
│   ├── core/               # Основная логика
│   │   ├── __init__.py
│   │   ├── document_checker.py
│   │   ├── pdf_parser.py
│   │   └── reference_index.py
│   ├── tests/              # Тесты
│   │   └── test_embeddings_cache.py
│   └── utils/              # Вспомогательные утилиты
│       └── text_normalizer.py
├── embeddings_cache/       # Кэш эмбеддингов
├── logs/                   # Логи
├── pdf_documents/          # PDF документы для обработки
├── requirements.txt        # Зависимости проекта
└── README.md               # Документация
```

## Установка

1. Клонируйте репозиторий:
```bash
git clone https://github.com/your-username/document-checker.git
cd document-checker
```

2. Создайте виртуальное окружение и активируйте его:
```bash
python -m venv .venv
# Windows
.venv\Scripts\activate
# Linux/Mac
source .venv/bin/activate
```

3. Установите зависимости:
```bash
pip install -r requirements.txt
```

## Использование

### Базовое использование

```bash
python -m document_checker.main
```

### Параметры командной строки

- `--reference, -r`: Путь к CSV файлу со справочными данными (по умолчанию: "combined_SP.csv")
- `--pdf_dir, -p`: Директория с PDF файлами для обработки (по умолчанию: "pdf_documents")
- `--cache_dir, -c`: Директория для кэширования эмбеддингов (по умолчанию: "embeddings_cache")
- `--save_embeddings, -s`: Сохранить эмбеддинги после обработки
- `--debug_pdf, -d`: Включить режим отладки PDF парсера
- `--pdf_file, -f`: Обработать только один указанный PDF файл
- `--force_rebuild, -b`: Принудительно пересоздать кэш эмбеддингов

### Примеры

Обработать все PDF файлы в указанной директории:
```bash
python -m document_checker.main --pdf_dir my_documents
```

Обработать один файл с включенным режимом отладки:
```bash
python -m document_checker.main --pdf_file "documents/example.pdf" --debug_pdf
```

Пересоздать кэш эмбеддингов:
```bash
python -m document_checker.main --force_rebuild
```

## Формат справочных данных

Входной CSV файл должен содержать как минимум две колонки:
- `Архив`: Название архивного отдела
- `Наименование`: Наименование организации

## Тестирование

Для запуска тестов выполните:
```bash
pytest document_checker/tests/
```
